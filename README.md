# Coffee N Pasete Project
## Project Introduction
### YOUTUBE
[![Coffee N Paste](https://img.youtube.com/vi/hV9tPMfjEeU/0.jpg)](https://youtu.be/hV9tPMfjEeU)

### WHO
#### ğŸ’» Front-end developer ::: 
- ğŸ† **ê°•íƒœí›ˆ** [FEë¦¬ë”]
  * ë©”ì¸í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜, ë©”ì¸ ì´ë¯¸ì§€ ê¸°ëŠ¥ êµ¬í˜„, ìƒì„¸í˜ì´ì§€ ê²Œì‹œê¸€ Read, ëŒ“ê¸€ CRUD, ë¬´í•œìŠ¤í¬ë¡¤
- ğŸ† **ë‚˜ìœ ì§„**
  * ê²Œì‹œê¸€ Add, ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°, ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•, ë©”ì†Œë¦¬ë‹ˆ ë ˆì´ì•„ì›ƒ, createPotal
- ğŸ† **ê³ í˜¸ì„±**
  * ë¡œê·¸ì¸*íšŒì›ê°€ì… ëª¨ë‹¬

#### ğŸ’» Back-end developer ::: 
- ğŸ† **ë°•ìƒìš±** [BEë¦¬ë”]
- ğŸ† **ê¹€íœ˜ë¦¼** [ì´ê´„]
- ğŸ† **ê¹€í˜„ì¤‘**
- ğŸ† **ìµœì¤€ìš°**

### WHEN
- 2022.08.12 ~ 2022.08.18

### WHAT
- Web Service 'Coffee N Paste'
- ::: ì»¤í”¼ í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ë³„ ë¦¬ë·° ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì„œë¹„ìŠ¤

### ì£¼ìš”ê¸°ëŠ¥
- ğŸ’» Infinite Scroll 
- ğŸ’» CreatePotal 
- ğŸ’» Image Upload 
- ğŸ’» Image Resizing(Compression) 
- ğŸ’» LogIn & SignIn 
- ğŸ’» Post CRUD
- ğŸ’» Comment CRUD

### Trouble Shooting
### FE

**1. ì´ë¯¸ì§€ í”„ë¦¬ë·° ì—…ë¡œë“œ ë° ë¦¬ì‚¬ì´ì§•, ì„œë²„ ì „ì†¡**
- Formdata í˜•ì‹, Multi Part ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ì „ì†¡ í•„ìš” â†’ FormData Web API ì‚¬ìš©í•´ì„œ í•´ê²°
- ì´ë¯¸ì§€ í”„ë¦¬ë·° ê¸°ëŠ¥ êµ¬í˜„ : ê¸°ëŠ¥ êµ¬í˜„ í›„ í™•ì¸í•´ë³´ë‹ˆ ì´ë¯¸ì§€ ìš©ëŸ‰ì´ ì»¤ì„œ ì‚¬ì´ì¦ˆ ì¤„ì¼ í•„ìš”ì„±ì„ ëŠë‚Œ â†’ browser-image-compression íŒ¨í‚¤ì§€ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆ ì¡°ì ˆ

**2. ê²Œì‹œê¸€ ì´ë¯¸ì§€(AWS S3) ì „ì†¡ í›„ ê²Œì‹œê¸€ ì»¨í…ì¸  ì „ì†¡**
- ê²Œì‹œê¸€ ë“±ë¡ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì´ë¯¸ì§€ ë° ê²Œì‹œê¸€ ì»¨í…ì¸ ê°€ í•œ ë²ˆì— ì „ì†¡ë˜ì—ˆìœ¼ë©´ í•¨. Async Await í™œìš©í•˜ì—¬ ìˆœì°¨ì ìœ¼ë¡œ ì „ì†¡ ì§„í–‰

**3. ëª¨ë‹¬ì°½ êµ¬í˜„ìœ¼ë¡œ ìƒì„¸ ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¬ ë•Œ ëœë”ë§ ì•ˆë˜ëŠ” í˜„ìƒ**
- CreatePortalí™œìš©í•˜ì—¬ ëª¨ë‹¬ ì°½ êµ¬í˜„ :  ê¸°ì¡´ ì‘ì—…ê³¼ ì¶©ëŒí˜„ìƒì´ ì¼ì–´ë‚˜ ëª¨ë‹¬ì°½ ì»¨í…ì¸ ì˜ ì´ˆê¸° ë Œë”ë§ì´ ì•ˆë¨ â†’ ìì‹ ì»¨í¬ë„ŒíŠ¸ë¡œ ëª¨ë‹¬ì°½ì„ ì´ë™ì‹œì¼œ í•´ê²°

**4. ë¬´í•œ ìŠ¤í¬ë¡¤ ê²Œì‹œê¸€ ì¤‘ë³µ í˜„ìƒ**
- ë©”ë‰´ë³„ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ì— ìˆì–´ ì–´ë ¤ì›€ì´ ìˆì—ˆìŒ : 


__ì´ ì™¸ì—ë„ ì—ëŸ¬ëŠ” ë§¤ì¼ ìˆì—ˆìŒâ€¦..!__

### BE

**1. member ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ Authentication ê°ì²´ ë§Œë“¤ê¸°**
    
```java
    // ì „
    UsernamePasswordAuthenticationToken authenticationToken =
            new UsernamePasswordAuthenticationToken(requestDto.getNickname(), requestDto.getPassword());
    
    Authentication authentication = authenticationManagerBuilder.getObject().authenticate(authenticationToken);
    
    TokenDto tokenDto = tokenProvider.generateTokenDto(authentication);
    
    // í›„
    UserDetailsImpl userDetails = new UserDetailsImpl(member);
    Authentication authentication = new UsernamePasswordAuthenticationToken(userDetails, "");
    
    TokenDto tokenDto = tokenProvider.generateTokenDto(authentication);
```
    

**2. ë°œê¸‰í•œ í† í°ì„ í—¤ë”ì— ë‹´ì•„ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚´ë©´ ë¸Œë¼ìš°ì €ê¹Œì§€ëŠ” ë„ë‹¬í•˜ëŠ”ë° Axios responseê¹Œì§€ëŠ” ë“¤ì–´ê°€ì§€ ì•Šì•„ì„œ responseBodyì— í† í°ì„ ë‹´ì•„ì„œ ë³´ë‚´ê¸°**
    
```java
    TokenDto token = memberService.login(loginRequestDto);
    
    // ì „
    HttpHeaders headers = new HttpHeaders();
    headers.setBearerAuth(token.getAuthorization());
    headers.add("Refresh-Token", token.getRefreshToken());
    
    return ResponseEntity.ok()
    					.headers(headers)
    					.body(Map.entry("msg", "ë¡œê·¸ì¸ ì™„ë£Œ"));
    
    // í›„
    return ResponseEntity.ok()
    					.body(token);
```
    

**3. CORS ê°€ëŠ¥í•˜ê²Œ í•˜ê¸°**
    
```java
    // ì „
    configuration.setAllowedOrigins(Arrays.asList("*"));
    
    // í›„
    configuration.setAllowedOrigin**Patterns**(Arrays.asList("*"));
```
    

**4. JWT í† í° Providerì—ì„œ bearerë¡œ ìƒì„±í•˜ê³  Filterì—ì„œ Bearerë¡œ ê²€ì¦í•˜ëŠ” ê²ƒìœ¼ë¡œ ë˜ì–´ìˆì—ˆì–´ì„œ ë‘˜ ë‹¤ Bearerë¡œ í†µì¼**
    
```java
    // ì „
    private static final String BEARER_TYPE = "bearer";
    
    // í›„
    private static final String BEARER_TYPE = "Bearer";
    
    return TokenDto.builder()
                    .authorization(BEARER_TYPE + " " + accessToken)
                    .refreshToken(refreshToken)
                    .build();
```
    

**5. ë¡œê·¸ì¸ ì‹œë„ë§ˆë‹¤ Refresh Tokenì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì–´ì„œ ì €ì¥ëœ ê°’ì„ í™•ì¸í•˜ë„ë¡ í•´ì„œ ìœ ì € í•œ ëª…ì— Refresh Token í•˜ë‚˜ì”© ì €ì¥ë˜ë„ë¡ ë³€ê²½í•˜ê¸°**
    
```java
    String refreshToken = Jwts.builder()
                    .setExpiration(new Date(now + REFRESH_TOKEN_EXPRIRE_TIME))
                    .signWith(key, SignatureAlgorithm.HS256)
                    .compact();
    
    //--- ì „
    RefreshToken refreshTokenObject = RefreshToken.builder()
                    .member(member)
                    .tokenValue(refreshToken)
                    .build();
    //---
    
    //--- í›„
    RefreshToken refreshTokenObject = refreshTokenRepository.findByMember(member)
    			.orElse(
    					RefreshToken.builder()
    							.member(member)
    							.build()
    			);
    refreshTokenObject.updateTokenValue(refreshToken);
    //---
    
    refreshTokenRepository.save(refreshTokenObject);
```
    

**6. ê²Œì‹œë¬¼ì´ 9ì‹œê°„ ì´ì „ìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ë¬¸ì œ í•´ê²°í•˜ê¸°**

```shell
   java -Duser.timezone=GMT+9 -jar í”„ë¡œê·¸ë¨
```

### íŒ¨í‚¤ì§€
- ìŠ¤íƒ€ì¼ ì ìš© : `styled-components`
- s3 ì—°ê²° : `aws-sdk`
- json-server (ì„œë²„) ì„¤ì¹˜(í…ŒìŠ¤íŠ¸ìš©) : `yarn add json-server`
- ë¦¬ë•ìŠ¤ ì„¤ì¹˜ : `yarn add react-redux`
- íˆ´í‚· (ë¦¬ë•ìŠ¤) ì„¤ì¹˜ : `yarn add @reduxjs/toolkit`
- thunk (ë¯¸ë“¤ì›¨ì–´) ì„¤ì¹˜ : `yarn add redux-thunk`
- axios(í†µì‹ ) ì„¤ì¹˜ : `yarn add axios` 
- logger (ê°œë°œ í¸í•˜ê²Œ ë„ì™€ì¤Œ) ì„¤ì¹˜ : `yarn add redux-loger`
- image resizing : `yarn add browser-image-compression`
- masorny ë ˆì´ì•„ì›ƒ ê¸°ëŠ¥ êµ¬í˜„ : `yarn add imagesloaded` (DOMì— ë¶€ì°©ëœ ì´ë¯¸ì§€ ë¡œë“œ ì‹œì  ì•Œê¸° ìœ„í•´ ì‚¬ìš©)

### git commit message ê·œì¹™
- íŒŒì¼ ìƒì„± âœ¨new : ~~~ ìƒì„±ì— ëŒ€í•œ ì»¤ë°‹
- íŒŒì¼ ì—…ë°ì´íŠ¸ ğŸš€update : ~~~ ì¶”ê°€ì— ëŒ€í•œ ì»¤ë°‹
- íŒŒì¼ ìˆ˜ì • âœ‚fix : ~~~ ìˆ˜ì •ì— ëŒ€í•œ ì»¤ë°‹
- íŒŒì¼ ì‚­ì œ ğŸ—‘delete : ~~~ ì‚­ì œì— ëŒ€í•œ ì»¤ë°‹

### í´ë” ë° ì»´í¬ë„ŒíŠ¸ êµ¬ì„±
<img src='https://github.com/YooJinRa/coffee-n-paste-FE/blob/master/documentImage/directoryFile1.png' width="100px" />
<img src='https://github.com/YooJinRa/coffee-n-paste-FE/blob/master/documentImage/directoryFile2.png' width="100px" />
